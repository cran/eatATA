<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Benjamin Becker, Dries Debeer" />

<meta name="date" content="2021-07-06" />

<title>Typical Use of eatATA: a Pilot Study Example</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Typical Use of <code>eatATA</code>: a Pilot Study Example</h1>
<h4 class="author">Benjamin Becker, Dries Debeer</h4>
<h4 class="date">2021-07-06</h4>



<p><code>eatATA</code> efficiently translates test design requirements for Automated Test Assembly (<code>ATA</code>) into constraints for a Mixed Integer Linear Programming Model (MILP). A number of efficient and user-friendly functions are available that translate conceptual test assembly constraints to constraint objects for MILP solvers, like the <code>GLPK</code> solver. In the remainder of this vignette I will illustrate the typical use of <code>eatATA</code> using a case-based example. A general overview over <code>eatATA</code> can be found in the vignette <a href="overview.html">Overview of <code>eatATA</code> Functionality</a>.</p>
<div id="setup" class="section level2">
<h2>Setup</h2>
<p>The <code>eatATA</code> package can be installed from <code>CRAN</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;eatATA&quot;</span>)</span></code></pre></div>
<p>First, <code>eatATA</code> is loaded into the <code>R</code> session.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># loading eatATA</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(eatATA)</span></code></pre></div>
</div>
<div id="item-pool" class="section level2">
<h2>Item pool</h2>
<p>No <code>ATA</code> without an item pool. In this example we use a fictional example item pool of 80 items. The item pool information is stored as an <code>excel</code> file that is included in the package. To import the item pool information into <code>R</code> we recommend using the package <code>readxl</code>. This package imports the data as a <code>tibble</code>, but in the code below, the item pool is immediately transformed into a <code>data.frame</code>.</p>
<p>Note that <code>R</code> requires a rectangular data set. Yet, often excel files store additional information in rows above or below the “rectangular” item pool information. The <code>skip</code> argument in the <code>read_excel()</code> function can be used to skip unnecessary rows in the <code>excel</code> file. (Note that the item pool can also be directly accessed in the package via <code>items</code>; see <code>?items</code> for more information.)</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>items_path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;items.xlsx&quot;</span>, <span class="at">package =</span> <span class="st">&quot;eatATA&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>items <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="at">path =</span> items_path), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Inspection of the item pool indicates that the items have different properties: item format (<code>MC</code>, <code>CMC</code>, <code>short_answer</code>, or <code>open</code>), difficulty (<code>diff_1</code> - <code>diff_5</code>), average response times in minutes (<code>time</code>). In addition, similar items can not be in the same booklet or test form. This information is stored in the column <code>exclusions</code>, which indicates which items are too similar and should not be in the same booklet with the item in that row..</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(items)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      item                exclusions time subitems MC CMC short_answer open</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 item_00          item_01, item_06  1.0        1 NA  NA            1   NA</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 item_01          item_00, item_06  1.5        1 NA  NA            1   NA</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 item_02 item_04, item_63, item_62  2.0        1 NA  NA           NA    1</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 item_03                      &lt;NA&gt;  1.5        1 NA  NA            1   NA</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 item_04 item_02, item_63, item_62  1.5        1 NA  NA            1   NA</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 item_05                      &lt;NA&gt;  1.0        1 NA  NA            1   NA</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   diff_1 diff_2 diff_3 diff_4 diff_5</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1      1     NA     NA     NA     NA</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     NA      1     NA     NA     NA</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     NA     NA      1     NA     NA</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4     NA     NA      1     NA     NA</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5     NA      1     NA     NA     NA</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6      1     NA     NA     NA     NA</span></span></code></pre></div>
</div>
<div id="prepare-item-information" class="section level2">
<h2>Prepare item information</h2>
<p>Before defining the constraints, item pool data has to be in the correct format. For instance, some dummy variables (indicator variables) in the item pool use both <code>NA</code> and <code>0</code> to indicate “the category does not apply”. Therefore, the dummy variables should be transformed so that there are only two values (1 = “the category applies”, and 0 = “the category does not apply”).</p>
<p>Often a set of dummy variables can be summarized into a single factor variable. This is automatically done by the function <code>dummiesToFactor()</code>. However, the function can only be used when the categories are mutually exclusive. For instance, in the example item pool, items can contain sub-items with different format or difficulties. As a result, some items contain two sub-items with different formats. Therefore, in this example, the <code>dummiesToFactor()</code> function throws an error and cannot be used.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clean data set (categorical dummy variables must contain only 0 and 1)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>items <span class="ot">&lt;-</span> <span class="fu">dummiesToFactor</span>(items, <span class="at">dummies =</span> <span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&quot;CMC&quot;</span>, <span class="st">&quot;short_answer&quot;</span>, <span class="st">&quot;open&quot;</span>), <span class="at">facVar =</span> <span class="st">&quot;itemFormat&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in dummiesToFactor(items, dummies = c(&quot;MC&quot;, &quot;CMC&quot;, &quot;short_answer&quot;, : All values in the &#39;dummies&#39; columns have to be 0, 1 or NA.</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>items <span class="ot">&lt;-</span> <span class="fu">dummiesToFactor</span>(items, <span class="at">dummies =</span> <span class="fu">paste0</span>(<span class="st">&quot;diff_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), <span class="at">facVar =</span> <span class="st">&quot;itemDiff&quot;</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in dummiesToFactor(items, dummies = paste0(&quot;diff_&quot;, 1:5), facVar = &quot;itemDiff&quot;): All values in the &#39;dummies&#39; columns have to be 0, 1 or NA.</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>items[<span class="fu">c</span>(<span class="dv">24</span>, <span class="dv">33</span>, <span class="dv">37</span>, <span class="dv">47</span>, <span class="dv">48</span>, <span class="dv">54</span>, <span class="dv">76</span>), ]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       item       exclusions time subitems MC CMC short_answer open diff_1</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 24 item_23             &lt;NA&gt;  3.5        2  1   1           NA   NA     NA</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 33 item_32          item_36  1.5        2 NA  NA            2   NA      1</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 37 item_36 item_27, item_32  1.5        2 NA  NA            2   NA      1</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 47 item_46 item_54, item_44  2.5        2 NA  NA            2   NA     NA</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 48 item_47 item_45, item_37  2.0        2 NA  NA            2   NA     NA</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 54 item_53 item_43, item_59  2.5        2 NA  NA            2   NA     NA</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 76 item_75             &lt;NA&gt;  1.5        2 NA  NA            2   NA     NA</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    diff_2 diff_3 diff_4 diff_5</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 24     NA      2     NA     NA</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 33     NA      1     NA     NA</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 37      1     NA     NA     NA</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 47      1      1     NA     NA</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 48     NA      1      1     NA</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 54      1      1     NA     NA</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 76     NA      1      1     NA</span></span></code></pre></div>
<p>In addition, the column <code>short_answer</code> can have NA as a value, and is consequently not a dummy variable. Therefore, we will (a) treat <code>short_answer</code> as a numerical value, (b) collapse <code>MC</code> and <code>open</code> into a new factor <code>MC_open_none</code>, (these dummies are mutually exclusive), and (c) turn <code>CMC</code> and the difficulty indicators into factors. (See <code>?autoItemValuesMinMax</code> and <code>?computeTargetValues</code> for further information on the different treatment of factors and numerical variables.)</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make new factor with three levels: &quot;MC&quot;, &quot;open&quot; and &quot;else&quot;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>items <span class="ot">&lt;-</span> <span class="fu">dummiesToFactor</span>(items, <span class="at">dummies =</span> <span class="fu">c</span>(<span class="st">&quot;MC&quot;</span>, <span class="st">&quot;open&quot;</span>), <span class="at">facVar =</span> <span class="st">&quot;MC_open_none&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in dummiesToFactor(items, dummies = c(&quot;MC&quot;, &quot;open&quot;), facVar = &quot;MC_open_none&quot;): For these rows, there is no dummy variable equal to 1: 1, 2, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 17, 20, 21, 25, 28, 29, 30, 32, 33, 34, 36, 37, 38, 39, 40, 41, 44, 45, 46, 47, 48, 50, 54, 55, 58, 60, 65, 67, 68, 69, 70, 72, 74, 76, 77, 79, 80</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; A &#39;_none_ &#39;category is created for these rows.</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># clean data set (NA should be 0)</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(ty <span class="cf">in</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;diff_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), <span class="st">&quot;CMC&quot;</span>, <span class="st">&quot;short_answer&quot;</span>)){</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  items[, ty] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(items[, ty]), <span class="at">yes =</span> <span class="dv">0</span>, <span class="at">no =</span> items[, ty])</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># make factors of CMC dummi</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>items<span class="sc">$</span>f_CMC <span class="ot">&lt;-</span> <span class="fu">factor</span>(items<span class="sc">$</span>CMC, <span class="at">labels =</span> <span class="fu">paste</span>(<span class="st">&quot;CMC&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>))</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># example item format</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(items<span class="sc">$</span>short_answer)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0  1  2 </span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 34 38  8</span></span></code></pre></div>
</div>
<div id="ata-goal" class="section level2">
<h2><code>ATA</code> goal</h2>
<p>In this example, the goal is to assemble 14 booklets out of the 80 items item pool. All items should be assigned to one (and only one booklet), so that there is no item overlap and the item pool is completely depleted.</p>
<p>To be more precise, the required constraints are:</p>
<ul>
<li><p>no item overlap between test blocks</p></li>
<li><p>complete item pool depletion</p></li>
<li><p>equal distribution of item formats across test blocks</p></li>
<li><p>equal difficulty distribution across test blocks</p></li>
<li><p>some items can not be together in the same booklet (item exclusions)</p></li>
<li><p>as similar as possible response times across booklets</p></li>
</ul>
<p>Note that the booklets will later be manually assembled to test forms.</p>
<p>For ease of use, we set up two variables that we will use frequently: the number of test forms or booklets to be created (<code>nForms</code>) and the number of items in the item pool (<code>nItems</code>).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up fixed variables</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>nItems <span class="ot">&lt;-</span> <span class="fu">nrow</span>(items)  <span class="co"># number of items</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>nForms <span class="ot">&lt;-</span> <span class="dv">14</span>           <span class="co"># number of blocks</span></span></code></pre></div>
<p><code>eatATA</code> offers a variety of functions that automatically compute the constraints mentioned above and which are illustrated in the following.</p>
</div>
<div id="objective-function" class="section level2">
<h2>Objective Function</h2>
<p>First, we are setting up an optimization constraint. This constraint is not a clear <em>yes</em> or <em>no</em> constraint, and it does not have to be attained perfectly. Instead, the solver will minimize the distance of the actual booklet value for all booklets towards a target value. In our example, we specify 10 minutes as the target response time <code>time</code> for all booklets.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># optimize average time</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>av_time <span class="ot">&lt;-</span> <span class="fu">minimaxObjective</span>(nForms, <span class="at">itemValues =</span> items<span class="sc">$</span>time, <span class="at">targetValue =</span> <span class="dv">10</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">itemIDs =</span> items<span class="sc">$</span>item)</span></code></pre></div>
</div>
<div id="set-up-constraints" class="section level2">
<h2>Set up constraints</h2>
<p>The first two constraints (no item overlap and item pool depletion) can be implemented by a single function: <code>itemUsageConstraint()</code>. To achieve this, the <code>operator</code> argument should be set to <code>&quot;=&quot;</code>, meaning that every item should be used exactly once in the booklet assembly.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>itemOverlap <span class="ot">&lt;-</span> <span class="fu">itemUsageConstraint</span>(nForms, <span class="at">targetValue =</span> <span class="dv">1</span>, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">operator =</span> <span class="st">&quot;=&quot;</span>, <span class="at">itemIDs =</span> items<span class="sc">$</span>item) </span></code></pre></div>
<p>Constraints with respect to categorical variables or factors (like <code>MC_open_none</code>) or numerical variables (like <code>short_answer</code>), can be easily implemented using the <code>autoItemValuesMinMax()</code> function. The result of this function depends on whether a factor or a numerical variable is used. That is, <code>autoItemValuesMinMax()</code> automatically determines the minimum and maximum frequency of each category of a factor. But for numerical variables, it automatically determines the target value.</p>
<p>The <code>allowedDeviation</code> argument specifies the allowed range between booklets regarding the category or the numerical value. If the argument is omitted, it defaults to “no deviation is allowed” for numerical values, and to the minimal possible deviation for categorical variables or factors. Hence, for numeric values, we specify <code>allowedDeviation = 1</code>. The function prints the calculated target value or the resulting allowed value range on booklet level.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># item formats</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>mc_openItems <span class="ot">&lt;-</span> <span class="fu">autoItemValuesMinMaxConstraint</span>(<span class="at">nForms =</span> nForms, <span class="at">itemValues =</span> items<span class="sc">$</span>MC_open_none, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">itemIDs =</span> items<span class="sc">$</span>item)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The minimum and maximum frequences per test form for each item category are</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        min max</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MC       1   2</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; _none_   3   4</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; open     0   1</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>cmcItems <span class="ot">&lt;-</span> <span class="fu">autoItemValuesMinMaxConstraint</span>(<span class="at">nForms =</span> nForms, <span class="at">itemValues =</span> items<span class="sc">$</span>f_CMC, <span class="at">itemIDs =</span> items<span class="sc">$</span>item)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The minimum and maximum frequences per test form for each item category are</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         min max</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; CMC_no    5   6</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; CMC_yes   0   1</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>saItems <span class="ot">&lt;-</span> <span class="fu">autoItemValuesMinMaxConstraint</span>(<span class="at">nForms =</span> nForms, <span class="at">itemValues =</span> items<span class="sc">$</span>short_answer, </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>                                <span class="at">allowedDeviation =</span> <span class="dv">1</span>, <span class="at">itemIDs =</span> items<span class="sc">$</span>item)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The minimum and maximum values per test form are: min = 2.86 - max = 4.86</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co"># difficulty categories</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>Items1 <span class="ot">&lt;-</span> <span class="fu">autoItemValuesMinMaxConstraint</span>(<span class="at">nForms =</span> nForms, <span class="at">itemValues =</span> items<span class="sc">$</span>diff_1, </span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>                               <span class="at">allowedDeviation =</span> <span class="dv">1</span>, <span class="at">itemIDs =</span> items<span class="sc">$</span>item)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The minimum and maximum values per test form are: min = 0 - max = 2</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>Items2 <span class="ot">&lt;-</span> <span class="fu">autoItemValuesMinMaxConstraint</span>(<span class="at">nForms =</span> nForms, <span class="at">itemValues =</span> items<span class="sc">$</span>diff_2, </span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>                               <span class="at">allowedDeviation =</span> <span class="dv">1</span>, <span class="at">itemIDs =</span> items<span class="sc">$</span>item)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The minimum and maximum values per test form are: min = 0.57 - max = 2.57</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>Items3 <span class="ot">&lt;-</span> <span class="fu">autoItemValuesMinMaxConstraint</span>(<span class="at">nForms =</span> nForms, <span class="at">itemValues =</span> items<span class="sc">$</span>diff_3, </span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>                               <span class="at">allowedDeviation =</span> <span class="dv">1</span>, <span class="at">itemIDs =</span> items<span class="sc">$</span>item)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The minimum and maximum values per test form are: min = 1.64 - max = 3.64</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>Items4 <span class="ot">&lt;-</span> <span class="fu">autoItemValuesMinMaxConstraint</span>(<span class="at">nForms =</span> nForms, <span class="at">itemValues =</span> items<span class="sc">$</span>diff_4, </span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>                               <span class="at">allowedDeviation =</span> <span class="dv">1</span>, <span class="at">itemIDs =</span> items<span class="sc">$</span>item)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The minimum and maximum values per test form are: min = 0 - max = 1.86</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>Items5 <span class="ot">&lt;-</span> <span class="fu">autoItemValuesMinMaxConstraint</span>(<span class="at">nForms =</span> nForms, <span class="at">itemValues =</span> items<span class="sc">$</span>diff_5, </span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>                               <span class="at">allowedDeviation =</span> <span class="dv">1</span>, <span class="at">itemIDs =</span> items<span class="sc">$</span>item)</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The minimum and maximum values per test form are: min = 0 - max = 1.29</span></span></code></pre></div>
<p>To implement item exclusion constraints, two function can be used: <code>itemExclusionTuples()</code> and <code>itemExclusionConstraint()</code>. When item exclusions are supplied as a single character string for each item, with item identifiers separated by <code>&quot;, &quot;</code>, they should be transformed first.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># item exclusions variable</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>items<span class="sc">$</span>exclusions[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;item_01, item_06&quot;          &quot;item_00, item_06&quot;         </span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3] &quot;item_04, item_63, item_62&quot; NA                         </span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [5] &quot;item_02, item_63, item_62&quot;</span></span></code></pre></div>
<p>This transformation can be done using the <code>itemExclusionTuples()</code> function, which creates so called <em>tuples</em>: pairs of exclusive items. These <em>tuples</em> can be used directly with the <code>itemExclusionConstraint()</code> function.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># item exclusions</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>exclusionTuples <span class="ot">&lt;-</span> <span class="fu">itemTuples</span>(items, <span class="at">idCol =</span> <span class="st">&quot;item&quot;</span>, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">infoCol =</span> <span class="st">&quot;exclusions&quot;</span>, <span class="at">sepPattern =</span> <span class="st">&quot;, &quot;</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>excl_constraints <span class="ot">&lt;-</span> <span class="fu">itemExclusionConstraint</span>(<span class="at">nForms =</span> <span class="dv">14</span>, <span class="at">itemTuples =</span> exclusionTuples, </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">itemIDs =</span> items<span class="sc">$</span>item)</span></code></pre></div>
<p>Another helpful function is the <code>itemsPerFormConstraint()</code> function, which constrains the number of items per booklet. However, since this is not required in this example, we will not use these constraints in the final <code>ATA</code> constraints.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of items per test form</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>min_Nitems <span class="ot">&lt;-</span> <span class="fu">floor</span>(nItems <span class="sc">/</span> nForms) <span class="sc">-</span> <span class="dv">3</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>noItems <span class="ot">&lt;-</span> <span class="fu">itemsPerFormConstraint</span>(<span class="at">nForms =</span> nForms, <span class="at">operator =</span> <span class="st">&quot;&gt;=&quot;</span>, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">targetValue =</span> min_Nitems, <span class="at">itemIDs =</span> items<span class="sc">$</span>item)</span></code></pre></div>
</div>
<div id="run-solver" class="section level2">
<h2>Run solver</h2>
<p>Before calling the optimization algorithm the specified constraints are collected in a <code>list</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare constraints</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>constr_list <span class="ot">&lt;-</span> <span class="fu">list</span>(itemOverlap, mc_openItems, cmcItems, saItems, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                      Items1, Items2, Items3, Items4, Items5, </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                      excl_constraints,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                      av_time)</span></code></pre></div>
<p>Now we can call the <code>useSolver()</code> function, which restructures the constraints internally and solves the optimization problem. Using the <code>solver</code> argument we specify <code>GLPK</code> as the solver (other alternatives are <code>lpSolve</code>, <code>Symphony</code> and <code>Gurobi</code>). Using the <code>timeLimit</code> argument we set the time limit to 10. This means we limit the solver to stop searching for an optimal solution after 10 seconds. Note that the computation times might depend on the solver you have selected.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimization</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>solver_raw <span class="ot">&lt;-</span> <span class="fu">useSolver</span>(constr_list, <span class="at">nForms =</span> nForms, <span class="at">nItems =</span> nItems, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">itemIDs =</span> items<span class="sc">$</span>item, <span class="at">solver =</span> <span class="st">&quot;GLPK&quot;</span>, <span class="at">timeLimit =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>#&gt;  [1] &quot;GLPK Simplex Optimizer, v4.47&quot;                                           
#&gt;  [2] &quot;1046 rows, 1121 columns, 12824 non-zeros&quot;                                
#&gt;  [3] &quot;      0: obj =  0.000000000e+000  infeas = 4.170e+002 (80)&quot;              
#&gt;  [4] &quot;*   411: obj =  5.879030940e-001  infeas = 7.963e-016 (0)&quot;               
#&gt;  [5] &quot;*   438: obj =  2.857142857e-001  infeas = 3.116e-029 (0)&quot;               
#&gt;  [6] &quot;OPTIMAL SOLUTION FOUND&quot;                                                  
#&gt;  [7] &quot;GLPK Integer Optimizer, v4.47&quot;                                           
#&gt;  [8] &quot;1046 rows, 1121 columns, 12824 non-zeros&quot;                                
#&gt;  [9] &quot;1120 integer variables, all of which are binary&quot;                         
#&gt; [10] &quot;Integer optimization begins...&quot;                                          
#&gt; [11] &quot;+   438: mip =     not found yet &gt;=              -inf        (1; 0)&quot;     
#&gt; [12] &quot;+  5675: &gt;&gt;&gt;&gt;&gt;  1.500000000e+000 &gt;=  2.857142857e-001  81.0% (303; 3)&quot;   
#&gt; [13] &quot;+  9322: &gt;&gt;&gt;&gt;&gt;  1.000000000e+000 &gt;=  2.857142857e-001  71.4% (540; 17)&quot;  
#&gt; [14] &quot;+ 17425: mip =  1.000000000e+000 &gt;=  2.857142857e-001  71.4% (799; 433)&quot; 
#&gt; [15] &quot;+ 26418: mip =  1.000000000e+000 &gt;=  2.857142857e-001  71.4% (1341; 491)&quot;
#&gt; [16] &quot;+ 34686: mip =  1.000000000e+000 &gt;=  2.857142857e-001  71.4% (1850; 551)&quot;
#&gt; [17] &quot;+ 45535: mip =  1.000000000e+000 &gt;=  2.857142857e-001  71.4% (2356; 644)&quot;
#&gt; [18] &quot;+ 54325: mip =  1.000000000e+000 &gt;=  2.857142857e-001  71.4% (2695; 737)&quot;
#&gt; [19] &quot;TIME LIMIT EXCEEDED; SEARCH TERMINATED&quot;
#&gt; The solution is feasible, but may not be optimal</code></pre>
<p>The function provides output that indicates whether an optimal solution has been found. In our case, a viable solution has been found but the function reached the time limit before finding the optimal solution.</p>
<p>If there is no feasible solution, one option is to relax some of the constraints. Further, for first diagnostic purposes you can omit some constraints completely, to see which constraints are especially challenging. If you have a better grasp of the possibilities of the item pool, you can add these constraints back, but for example with larger <code>allowedDeviations</code>.</p>
</div>
<div id="inspect-solution" class="section level2">
<h2>Inspect Solution</h2>
<p>The solution provided by <code>eatATA</code> can be inspected using the <code>inspectSolution()</code> function. It allows us to inspect the assembled item blocks at a first glance, including some column sums.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>out_list <span class="ot">&lt;-</span> <span class="fu">inspectSolution</span>(solver_raw, <span class="at">items =</span> items, <span class="at">idCol =</span> <span class="st">&quot;item&quot;</span>, <span class="at">colSums =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">colNames =</span> <span class="fu">c</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;subitems&quot;</span>, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">&quot;MC&quot;</span>, <span class="st">&quot;CMC&quot;</span>, <span class="st">&quot;short_answer&quot;</span>, <span class="st">&quot;open&quot;</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">paste0</span>(<span class="st">&quot;diff_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># first two booklets</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>out_list[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $form_1</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     time subitems MC CMC short_answer open diff_1 diff_2 diff_3 diff_4 diff_5</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17   2.0        1 NA   0            1   NA      0      0      0      0      1</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 19   2.0        1  1   0            0   NA      0      0      0      1      0</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 27   1.5        1  1   0            0   NA      0      0      1      0      0</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 41   1.0        1 NA   0            1   NA      0      0      1      0      0</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 44   1.5        1 NA   0            1   NA      0      1      0      0      0</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 55   1.0        1 NA   0            1   NA      0      1      0      0      0</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sum  9.0        6 NA   0            4   NA      0      2      2      1      1</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $form_2</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     time subitems MC CMC short_answer open diff_1 diff_2 diff_3 diff_4 diff_5</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    1.0        1 NA   0            1   NA      1      0      0      0      0</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10   1.0        1  1   0            0   NA      0      1      0      0      0</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 20   1.5        1 NA   0            1   NA      0      0      1      0      0</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 22   2.5        1  1   0            0   NA      0      0      1      0      0</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 66   2.5        1 NA   0            0    1      0      1      0      0      0</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 76   1.5        2 NA   0            2   NA      0      0      1      1      0</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sum 10.0        7 NA   0            4   NA      1      2      3      1      0</span></span></code></pre></div>
<p>In our case we want to assemble the created booklets into test forms. Therefore, we are interested in booklet exclusions that can result from item exclusions. The <code>analyzeBlockExclusion()</code> function can be used to obtain tuples with booklet exclusions.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">analyzeBlockExclusion</span>(<span class="at">solverOut =</span> solver_raw, <span class="at">item =</span> items, <span class="at">idCol =</span> <span class="st">&quot;item&quot;</span>, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">exclusionTuples =</span> exclusionTuples)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Name 1  Name 2</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  form_12  form_2</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  form_11  form_2</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  form_11 form_12</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  form_13  form_5</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  form_13  form_4</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  form_13  form_6</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7   form_4  form_5</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8   form_5  form_6</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9  form_12  form_4</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 form_10  form_7</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11 form_10 form_13</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12 form_10  form_2</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13  form_6  form_9</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14 form_13  form_3</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15 form_13  form_7</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16  form_2  form_7</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17 form_13  form_2</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18 form_11  form_8</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 19  form_1 form_12</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 20  form_1 form_14</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 22 form_12  form_9</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 23 form_10  form_6</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 25  form_1 form_10</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 26 form_13  form_8</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 27 form_11  form_3</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 28  form_3  form_4</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 29  form_5  form_8</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 32  form_5  form_7</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 35  form_1  form_3</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 37  form_1  form_9</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 38 form_12  form_3</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 39  form_1  form_6</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 40 form_12 form_14</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 41  form_3  form_8</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 42 form_14  form_3</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 44  form_4  form_6</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 45 form_12  form_7</span></span></code></pre></div>
</div>
<div id="save-as-excel" class="section level2">
<h2>Save as Excel</h2>
<p>To save the item distribution on blocks or test forms, we can use the <code>appendSolution()</code> function. The function simply merges the new variables containing the solution to the test assembly problem to the original item pool.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>out_df <span class="ot">&lt;-</span> <span class="fu">appendSolution</span>(solver_raw, <span class="at">items =</span> items, <span class="at">idCol =</span> <span class="st">&quot;item&quot;</span>)</span></code></pre></div>
<p>Finally, when the solution should be exported as an <code>excel</code> file (<code>.xlsx</code>), this can, for example, be achieved via the <code>eatAnalysis</code> package, which has to be installed from <code>Github</code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;beckerbenj/eatAnalysis&quot;</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>eatAnalysis<span class="sc">::</span><span class="fu">write_xlsx</span>(out_df, <span class="at">filePath =</span> <span class="st">&quot;example_excel.xlsx&quot;</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
